# ë°ì´í„° ì „ì²˜ë¦¬ ë¬¸ì„œ

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
new/
â”œâ”€â”€ law_data/              # ì›ë³¸ ì„¼ì„œ ë°ì´í„° (187ê°œ íŒŒì¼)
â”œâ”€â”€ processed_data/        # ì „ì²˜ë¦¬ëœ ë°ì´í„° (187ê°œ íŒŒì¼) âœ…
â”œâ”€â”€ node_data/             # ë…¸ë“œ ìš”ì•½ ë°ì´í„° (187ê°œ íŒŒì¼)
â”œâ”€â”€ nodes_final.csv        # ë§ˆì»¤ ì¢Œí‘œ ì •ë³´
â””â”€â”€ convert_raw_with_all_data.py  # ì „ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸
```

## ğŸ“Š ë°ì´í„° ê°œìš”

### í•µì‹¬ ìš©ì–´ ì •ì˜

- **ë§ˆì»¤(Marker)**: ê±°ë¦¬ê°€ ë¨¼ ì£¼ìš” ì§€ì  (ID: 1~30ë²ˆ)
  - ì˜ˆ: ë§ˆì»¤ 1 (0.0, 0.0), ë§ˆì»¤ 11 (-45.0, 0.0), ë§ˆì»¤ 23 (-13.5, -9.0)

- **ë…¸ë“œ(Node)**: ê° ë§ˆì»¤ë‹¹ **0.45m ê°„ê²©**ìœ¼ë¡œ êµ¬ë¶„ëœ ì„¸ë¶€ ìœ„ì¹˜
  - ì‹¤ì œ ì´ë™ ì‹œ 0.45më§ˆë‹¤ ì¸¡ì • ìˆ˜í–‰
  - `Highlighted=True` í–‰ì´ ê° ë…¸ë“œ ë„ì°© ì§€ì 

- **ê²½ë¡œ êµ¬ì¡°**: ëª¨ë“  ì´ë™ì€ **ì§ê°(Manhattan) ê²½ë¡œ**
  - x ë˜ëŠ” y ì¤‘ **í•˜ë‚˜ì˜ ì¶•ë§Œ** ë³€í™”
  - ëŒ€ê°ì„  ì´ë™ ì—†ìŒ
  - ì§ê° íšŒì „ ì§€ì ì€ `RightAngle=True`ë¡œ í‘œì‹œ

### íŒŒì¼ëª… ê·œì¹™

```
{from_marker}_{to_marker}_{count}.csv
```

- `from_marker`: ì‹œì‘ ë§ˆì»¤ ID
- `to_marker`: ë„ì°© ë§ˆì»¤ ID
- `count`: ë™ì¼ ê²½ë¡œì˜ ì¸¡ì • íšŒì°¨

**ì˜ˆì‹œ**:
- `1_23_6.csv`: ë§ˆì»¤ 1 â†’ ë§ˆì»¤ 23, 6ë²ˆì§¸ ì¸¡ì •
- `11_1_2.csv`: ë§ˆì»¤ 11 â†’ ë§ˆì»¤ 1, 2ë²ˆì§¸ ì¸¡ì •

## ğŸ“‚ ë°ì´í„° íŒŒì¼ ì„¤ëª…

### 1. `law_data/` (ì›ë³¸ ë°ì´í„°)

**íŠ¹ì§•**:
- ì´ 187ê°œ íŒŒì¼
- í‰ê·  1,844í–‰/íŒŒì¼
- ì„¼ì„œ ìƒ˜í”Œë§ ì£¼ê¸°: ì•½ 200ms (ì¶”ì •)

**ë°ì´í„° êµ¬ì¡°**:
```
Timestamp, AccX, AccY, AccZ, GyroX, GyroY, GyroZ,
MagX, MagY, MagZ, Pitch, Roll, Yaw, Highlighted, RightAngle
```

**ì»¬ëŸ¼ ì„¤ëª…**:
- `Timestamp`: ì¸¡ì • ì‹œê° (ISO 8601)
- `AccX/Y/Z`: ê°€ì†ë„ê³„ (m/sÂ²)
- `GyroX/Y/Z`: ìì´ë¡œìŠ¤ì½”í”„ (rad/s)
- `MagX/Y/Z`: **ì§€ìê¸° ì„¼ì„œ (Î¼T)** â­
- `Pitch/Roll/Yaw`: **ë°©í–¥ ë²¡í„° (ë„)** â­
- `Highlighted`: ë…¸ë“œ ë„ì°© ì—¬ë¶€ (True/False)
- `RightAngle`: ì§ê° íšŒì „ ì§€ì  (True/False)

**íŠ¹ì§•**:
- ì¢Œí‘œ(x, y) ì •ë³´ **ì—†ìŒ**
- ì„¼ì„œ ë°ì´í„°ë§Œ í¬í•¨

### 2. `processed_data/` (ì „ì²˜ë¦¬ ì™„ë£Œ) âœ… **ë©”ì¸ ë°ì´í„°**

**íŠ¹ì§•**:
- ì´ 187ê°œ íŒŒì¼
- ì´ 344,929í–‰
- **ëª¨ë“  ì›ë³¸ ë°ì´í„° ë³´ì¡´**
- **(x, y) ì¢Œí‘œ ì¶”ê°€ë¨** â­

**ë°ì´í„° êµ¬ì¡°**:
```
x, y, MagX, MagY, MagZ, Pitch, Roll, Yaw, Highlighted, RightAngle
```

**ì»¬ëŸ¼ ì„¤ëª…**:
- `x`: X ì¢Œí‘œ (ë¯¸í„°, ì†Œìˆ˜ì  2ìë¦¬)
- `y`: Y ì¢Œí‘œ (ë¯¸í„°, ì†Œìˆ˜ì  2ìë¦¬)
- `MagX/Y/Z`: ì§€ìê¸° ë²¡í„° (Î¼T)
- `Pitch/Roll/Yaw`: ë°©í–¥ ë²¡í„° (ë„)
- `Highlighted`: ë…¸ë“œ ë„ì°© í‘œì‹œ
- `RightAngle`: ì§ê° íšŒì „ í‘œì‹œ

**ì¢Œí‘œ í• ë‹¹ ë°©ì‹**:
1. `Highlighted=True` í–‰ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ë…¸ë“œ ì¢Œí‘œ ê³„ì‚° (0.45m ê°„ê²©)
2. ë…¸ë“œ ê°„ ëª¨ë“  ë°ì´í„°ëŠ” **ì„ í˜• ë³´ê°„**ìœ¼ë¡œ ì¢Œí‘œ ë¶€ì—¬
3. ì§ê° ê²½ë¡œëŠ” `RightAngle` ì •ë³´ë¡œ ìë™ ê°ì§€

**ì˜ˆì‹œ (`1_23_6.csv`)**:
```
í–‰ 0~8:    (0.00, 0.0) â†’ (-0.45, 0.0)  # 0ë²ˆ ë…¸ë“œë¡œ ì´ë™
í–‰ 9~31:   (-0.45, 0.0) â†’ (-0.90, 0.0) # 1ë²ˆ ë…¸ë“œë¡œ ì´ë™
...
í–‰ ~751:   x ë°©í–¥ ì´ë™ (-12.60, 0.0)  # 28ë²ˆ ë…¸ë“œ (ì§ê° íšŒì „ì )
í–‰ 752~:   y ë°©í–¥ ì´ë™ (-12.60, -0.45) # 29ë²ˆ ë…¸ë“œë¶€í„° y ì´ë™
```

**ë°ì´í„° í’ˆì§ˆ**:
- ì „ì²´ 1,260í–‰ ì¤‘ ê³ ìœ  (x, y) ì¡°í•©: 1,201ê°œ (95%)
- ì¤‘ë³µ ì¢Œí‘œ: ì£¼ë¡œ yì¶• ì´ë™ êµ¬ê°„ (x ê³ ì •)

### 3. `node_data/` (ë…¸ë“œ ìš”ì•½ ë°ì´í„°)

**íŠ¹ì§•**:
- ì´ 187ê°œ íŒŒì¼
- ì´ 12,179ê°œ ë…¸ë“œ
- **ë…¸ë“œë‹¹ 1í–‰ìœ¼ë¡œ ìš”ì•½**

**ë°ì´í„° êµ¬ì¡°**:
```
node_index, x, y, mag_x, mag_y, mag_z,
pitch, roll, yaw, right_angle,
from_marker, to_marker, segment_size, total_nodes
```

**ì»¬ëŸ¼ ì„¤ëª…**:
- `node_index`: ë…¸ë“œ ì¸ë±ìŠ¤ (0ë¶€í„° ì‹œì‘)
- `x, y`: ë…¸ë“œ ì¢Œí‘œ
- `mag_x/y/z`: ì§€ìê¸° **í‰ê· ê°’** (í•´ë‹¹ êµ¬ê°„)
- `pitch/roll/yaw`: ë°©í–¥ **í‰ê· ê°’** (í•´ë‹¹ êµ¬ê°„)
- `right_angle`: ì§ê° íšŒì „ ë…¸ë“œ ì—¬ë¶€
- `from_marker, to_marker`: ì‹œì‘/ë„ì°© ë§ˆì»¤
- `segment_size`: í•´ë‹¹ ë…¸ë“œì˜ ì›ë³¸ ë°ì´í„° í–‰ ìˆ˜
- `total_nodes`: ì „ì²´ ë…¸ë“œ ìˆ˜

**ìš©ë„**:
- ë¹ ë¥¸ ë…¸ë“œë³„ í†µê³„ í™•ì¸
- ê²½ë¡œ ì‹œê°í™”
- ë…¸ë“œ ìˆ˜ì¤€ ë¶„ì„

### 4. `nodes_final.csv` (ë§ˆì»¤ ì •ë³´)

**ë°ì´í„° êµ¬ì¡°**:
```
id, name, x_m, y_m, type
```

**ë‚´ìš©**:
- ì´ 29ê°œ ë§ˆì»¤
- ë§ˆì»¤ 1~20: -x ë°©í–¥ ì§ì„  ë°°ì¹˜ (0.0 â†’ -85.5)
- ë§ˆì»¤ 21~29: êµì°¨ì  ë° ìˆ˜ì§ ë°©í–¥

**ì˜ˆì‹œ**:
```
1,1,0.0,0.0,marker
11,11,-45.0,0.0,marker
23,23,-13.5,-9.0,marker
```

## ğŸ”„ ì „ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤

### ì‹¤í–‰ ë°©ë²•

```bash
python3 convert_raw_with_all_data.py
```

### ì²˜ë¦¬ ë‹¨ê³„

1. **ë§ˆì»¤ ì •ë³´ ë¡œë“œ** (`nodes_final.csv`)
2. **ê° íŒŒì¼ë³„ ì²˜ë¦¬**:
   - `Highlighted=True` í–‰ ì¸ë±ìŠ¤ ì¶”ì¶œ
   - `RightAngle=True` ìœ„ì¹˜ í™•ì¸
   - ë…¸ë“œ ì¢Œí‘œ ê³„ì‚° (0.45m ê°„ê²©, ì§ê° ê²½ë¡œ)
   - ëª¨ë“  ë°ì´í„° í–‰ì— ì¢Œí‘œ ë³´ê°„
3. **ê²°ê³¼ ì €ì¥** (`processed_data/`)

### ì¢Œí‘œ ê³„ì‚° ë¡œì§

#### ì§ì„  ê²½ë¡œ (x ë˜ëŠ” yë§Œ ë³€í™”)
```python
# ì˜ˆ: ë§ˆì»¤ 11 (-45.0, 0.0) â†’ ë§ˆì»¤ 1 (0.0, 0.0)
# 100ê°œ ë…¸ë“œ
ë…¸ë“œ 0: (-45.00, 0.0)
ë…¸ë“œ 1: (-44.55, 0.0)
ë…¸ë“œ 2: (-44.10, 0.0)
...
ë…¸ë“œ 99: (-0.45, 0.0)
```

#### ì§ê° ê²½ë¡œ (xì™€ y ëª¨ë‘ ë³€í™”)
```python
# ì˜ˆ: ë§ˆì»¤ 1 (0.0, 0.0) â†’ ë§ˆì»¤ 23 (-13.5, -9.0)
# 48ê°œ ë…¸ë“œ, 28ë²ˆ ë…¸ë“œì—ì„œ ì§ê° íšŒì „

# x ë°©í–¥ ì´ë™ (0~28ë²ˆ ë…¸ë“œ)
ë…¸ë“œ 0~27: x ê°ì†Œ, y=0.0 ê³ ì •
ë…¸ë“œ 28: (-12.60, 0.0)  # ì§ê° íšŒì „ì 

# y ë°©í–¥ ì´ë™ (29~47ë²ˆ ë…¸ë“œ)
ë…¸ë“œ 29~47: x=-12.60 ê³ ì •, y ê°ì†Œ
```

#### ë³´ê°„ ë°©ì‹
```python
# ë…¸ë“œ ê°„ ì„¼ì„œ ë°ì´í„°ëŠ” ì„ í˜• ë³´ê°„
êµ¬ê°„ n: highlighted[n-1]+1 ~ highlighted[n]

# ì˜ˆ: 9~31ë²ˆ í–‰ (ë…¸ë“œ 0 â†’ ë…¸ë“œ 1)
í–‰ 9:  ratio=0/23,  pos = 0ë²ˆ_ë…¸ë“œ + 0% * (1ë²ˆ_ë…¸ë“œ - 0ë²ˆ_ë…¸ë“œ)
í–‰ 10: ratio=1/23,  pos = 0ë²ˆ_ë…¸ë“œ + 4.3% * (1ë²ˆ_ë…¸ë“œ - 0ë²ˆ_ë…¸ë“œ)
...
í–‰ 31: ratio=23/23, pos = 1ë²ˆ_ë…¸ë“œ
```

## ğŸ“ˆ ë°ì´í„° í†µê³„

### ì „ì²´ í†µê³„
```
íŒŒì¼ ìˆ˜: 187ê°œ
ì´ í–‰ ìˆ˜: 344,929í–‰
ì´ ë…¸ë“œ ìˆ˜: 12,179ê°œ
í‰ê·  í–‰/íŒŒì¼: 1,844.5í–‰
í‰ê·  ë…¸ë“œ/íŒŒì¼: 65.1ê°œ
```

### ì„¼ì„œ ë°ì´í„° ë²”ìœ„ (ì˜ˆì‹œ: 1â†’23 ê²½ë¡œ)
```
ì§€ìê¸° (MagX, MagY, MagZ):
  X: [-46.30, 70.90] Î¼T
  Y: [-98.89, 37.58] Î¼T
  Z: [-47.65, 62.17] Î¼T

ë°©í–¥ (Pitch, Roll, Yaw):
  Pitch: [-10Â°, 10Â°] (ì¶”ì •)
  Roll:  [-15Â°, 15Â°] (ì¶”ì •)
  Yaw:   [0Â°, 360Â°]
```

### ê²½ë¡œë³„ í†µê³„
```
ë§ˆì»¤ ìŒ ìˆ˜: 69ê°œ
ìµœì†Œ ë…¸ë“œ: 31ê°œ (8â†’24 ê²½ë¡œ)
ìµœëŒ€ ë…¸ë“œ: 103ê°œ (11â†’21 ê²½ë¡œ)
ì§ê° ê²½ë¡œ: ì•½ 30% (RightAngle í¬í•¨ ê²½ë¡œ)
```

## ğŸ¯ ì‚¬ìš© ì˜ˆì‹œ

### 1. íŠ¹ì • ê²½ë¡œ ë°ì´í„° ë¡œë“œ

```python
import pandas as pd

# ë§ˆì»¤ 1 â†’ 23 ê²½ë¡œ (6ë²ˆì§¸ ì¸¡ì •)
df = pd.read_csv('processed_data/1_23_6.csv')

print(f"ì´ ë°ì´í„°: {len(df)}í–‰")
print(f"ë…¸ë“œ ìˆ˜: {df['Highlighted'].sum()}ê°œ")
print(f"ì§ê° íšŒì „: {df['RightAngle'].sum()}íšŒ")
```

### 2. ë…¸ë“œë³„ ì„¼ì„œ ë°ì´í„° ì¶”ì¶œ

```python
# Highlighted í–‰ë§Œ ì¶”ì¶œ = ë…¸ë“œ ìœ„ì¹˜
nodes = df[df['Highlighted'] == True].copy()

print(nodes[['x', 'y', 'MagX', 'MagY', 'MagZ']])
```

### 3. íŠ¹ì • ì¢Œí‘œì˜ ì„¼ì„œ ê°’ ì¡°íšŒ

```python
# ì¢Œí‘œ (-5.0, 0.0) ê·¼ì²˜ ë°ì´í„°
target = df[(df['x'].between(-5.1, -4.9)) &
            (df['y'].between(-0.1, 0.1))]

print(target[['x', 'y', 'MagX', 'MagY', 'MagZ', 'Pitch', 'Roll', 'Yaw']])
```

### 4. ê²½ë¡œ ì‹œê°í™”

```python
import matplotlib.pyplot as plt

# ì´ë™ ê²½ë¡œ ê·¸ë¦¬ê¸°
plt.figure(figsize=(12, 8))
plt.plot(df['x'], df['y'], 'b-', alpha=0.3, linewidth=0.5)

# ë…¸ë“œ í‘œì‹œ
nodes = df[df['Highlighted'] == True]
plt.scatter(nodes['x'], nodes['y'], c='red', s=50, zorder=5)

# ì§ê° íšŒì „ ì§€ì  ê°•ì¡°
ra = df[df['RightAngle'] == True]
if len(ra) > 0:
    plt.scatter(ra['x'], ra['y'], c='yellow', s=200,
                marker='*', zorder=10, label='Right Angle')

plt.xlabel('X (m)')
plt.ylabel('Y (m)')
plt.title('Path: Marker 1 â†’ 23')
plt.grid(True, alpha=0.3)
plt.axis('equal')
plt.legend()
plt.show()
```

### 5. ì§€ìê¸° íˆíŠ¸ë§µ ìƒì„±

```python
import numpy as np
from scipy.interpolate import griddata

# ê·¸ë¦¬ë“œ ìƒì„±
xi = np.linspace(df['x'].min(), df['x'].max(), 100)
yi = np.linspace(df['y'].min(), df['y'].max(), 100)
Xi, Yi = np.meshgrid(xi, yi)

# ì§€ìê¸° ê°•ë„ ë³´ê°„
mag_strength = np.sqrt(df['MagX']**2 + df['MagY']**2 + df['MagZ']**2)
Zi = griddata((df['x'], df['y']), mag_strength, (Xi, Yi), method='cubic')

# íˆíŠ¸ë§µ ê·¸ë¦¬ê¸°
plt.figure(figsize=(12, 8))
plt.contourf(Xi, Yi, Zi, levels=20, cmap='viridis')
plt.colorbar(label='Magnetic Field Strength (Î¼T)')
plt.scatter(df['x'], df['y'], c='white', s=1, alpha=0.3)
plt.xlabel('X (m)')
plt.ylabel('Y (m)')
plt.title('Magnetic Field Heatmap')
plt.axis('equal')
plt.show()
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ë°ì´í„° íŠ¹ì„±
1. **ì²« ë²ˆì§¸ êµ¬ê°„**: 0ë²ˆ ë…¸ë“œ êµ¬ê°„ì€ ì‹œì‘ì ì—ì„œ 1ë²ˆ ë…¸ë“œë¡œ ë³´ê°„
2. **ì§ê° íšŒì „**: RightAngle í–‰ì€ íšŒì „ì´ **ë°œìƒí•˜ëŠ” êµ¬ê°„** ë‚´ì— ìœ„ì¹˜
3. **ì¢Œí‘œ ì •ë°€ë„**: ì†Œìˆ˜ì  2ìë¦¬ (ì„¼í‹°ë¯¸í„° ë‹¨ìœ„)
4. **yì¶• ì´ë™ êµ¬ê°„**: x ì¢Œí‘œê°€ ë™ì¼í•˜ê²Œ ë°˜ë³µë¨ (ì •ìƒ)
