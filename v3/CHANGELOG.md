# Version 3: Stride 축소 + 데이터 증강 (최종)

## 📋 개요
Stride를 축소하고 보수적인 데이터 증강을 적용한 최종 버전

## 🔧 전처리 전략
- **데이터 소스**: 마커 사이 모든 샘플 활용
- **Window 크기**: 100 샘플 (마커 이전 100 샘플)
- **Stride**: 5 샘플 (v2의 10에서 축소)
- **데이터 증강**: 30% 샘플에 센서 노이즈 수준 적용
  - 지자기 노이즈: Gaussian(μ=0, σ=0.8μT)
  - 방향 노이즈: Gaussian(μ=0, σ=1.5°)
- **클래스 필터링**: 10개 미만 샘플 클래스 제거

## 📊 데이터셋 통계
- **총 샘플**: 84,358개 (v2 대비 2.2배 증가, v1 대비 6.9배)
- **고유 클래스**: 2,152개 (필터링 후)
- **클래스당 평균 샘플**: 39.2개 ✅
- **Train/Val/Test**: 60,524 / 10,686 / 13,148 샘플

### 📈 클래스 분포
- **20-50개 샘플**: 680개 클래스
- **50-100개 샘플**: 250개 클래스
- **100개+ 샘플**: 66개 클래스
- **< 10개 샘플**: 0개 (모두 필터링됨)

## 🔍 입력/출력 사양
- **입력 shape**: (batch, 100, 6)
  - 100 timesteps (2초, ~2걸음)
  - 6 features: [MagX, MagY, MagZ, Pitch, Roll, Yaw]
- **출력**: 2,152개 클래스 (그리드 셀 ID)

## ✅ 개선점
- ✅ **Stride 축소 (10→5)**: 샘플 2배 증가
- ✅ **보수적 증강**: 센서 노이즈 수준만 추가 (30% 샘플)
- ✅ **클래스 필터링**: 학습 불가능한 소수 샘플 클래스 제거
- ✅ **클래스당 평균 39.2개**: LSTM 학습 가능한 수준!

## 🎯 데이터 품질
| 항목 | v1 | v2 | v3 | 개선 |
|------|----|----|-----|------|
| 총 샘플 | 12,179 | 38,747 | 84,358 | **6.9배** |
| 클래스당 평균 | 5.2개 | 15.6개 | 39.2개 | **7.5배** |
| < 10개 샘플 클래스 | 620개 | 620개 | 0개 | ✅ |
| 학습 가능성 | ❌ | ⚠️ | ✅ | ✅ |

## 📂 파일
- `preprocessing_v3.py`: 전처리 스크립트
- `processed_data_v3/`: 생성된 데이터셋
  - X_train.npy, y_train.npy (60,524 샘플)
  - X_val.npy, y_val.npy (10,686 샘플)
  - X_test.npy, y_test.npy (13,148 샘플)
  - metadata.pkl
- `train_lstm.py`: LSTM 모델 학습 스크립트

## 🚀 LSTM 모델
- **구조**: 4층 LSTM (128 → 256 → 256 → 128)
- **총 파라미터**: 1,432,288개 (5.46 MB)
- **Batch size**: 128
- **Epochs**: 100 (Early Stopping: patience=15)

## 🔄 다음 단계
→ LSTM 모델 학습 및 평가
